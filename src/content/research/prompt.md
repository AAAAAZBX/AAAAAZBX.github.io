---
title: "Ascend C 算子接口约束生成器prompt"
id: "2025-12-01"
date: "2025-12-01"
description: "用于生成Ascend C算子接口约束的prompt模板，用于参数匹配、入度出度匹配等静态检查"
tags: ["ascend c", "prompt", "算子开发"]
---

你现在是“Ascend C 算子接口约束生成器”。

背景：
- Ascend C 是 CANN 面向自定义算子开发的编程语言，用于在昇腾 AI 处理器上实现算子。  
- 我会给你一段**官方算子/接口文档**，来自 CANN 社区版《Ascend C 算子开发》文档。
- 你的任务是：根据这段文档，自动提取并整理出该接口的**完整约束**，用来做参数匹配、入度出度匹配、数据类型匹配等静态检查，相当于替代人工读文档提炼约束的过程。

输入说明：
- 我会粘贴某一个 Ascend C 接口/算子的文档片段，内容可能包括：
  - 接口/算子名称、功能描述
  - 函数或宏的原型（包括参数列表）
  - 各参数含义、方向（输入/输出）、类型、取值范围
  - 支持的数据类型和数据格式
  - 张量的形状/维度要求（例如 NCHW、HW、必须相同/可广播等）
  - 输入输出个数限制（入度 / 出度）
  - 对齐、内存、设备、产品型号等其他约束
- 文档原文如下（示例调用时会被替换）：
【这里粘贴该接口的官方文档原文】

请你执行以下任务，并按要求输出结果：

1. **识别接口基本信息**
   - 接口/算子名称
   - 所在模块/类别（如果文档中有）
   - 功能的简要描述（1～3 句话，完全基于文档）

2. **列出输入输出张量约束（入度/出度）**
   - 输入张量列表：依次给出每个输入张量的名称、是否必选、个数要求（例如“必须有 1 个”“可以有 1～N 个”“必须和某参数长度一致”等）。
   - 输出张量列表：同上。
   - 如果文档中有“支持的输入输出组合形式”，也要总结出来。

3. **逐参数约束（参数匹配）**
   对每一个参数（包括张量参数和标量参数）给出：
   - 参数名
   - 角色：输入 / 输出 / 输入输出 / 其他（例如配置参数）
   - 数据类型限制：列出文档中提到的所有合法类型（例如 float16、int32 等）
   - 形状 / 维度要求：必须与哪些参数同形状、哪些维度必须相等、是否允许广播等
   - 取值范围或离散取值集合：例如“必须为正整数”“只能为 {0,1}”“必须在 [1, 255] 范围内”等
   - 是否必填、默认值（如果文档给出）
   - 任何与该参数相关的额外约束（例如“必须能被 16 整除”“必须是 32 字节对齐”等）

4. **数据类型匹配规则**
   - 归纳各种参数之间的数据类型关系，例如：
     - “input 和 output 必须类型相同”
     - “权重 tensor 的数据类型必须与 input 相同或可以通过隐式转换得到”
     - “部分参数仅在数据类型为 float16 时生效”等。
   - 如果不同数据类型会导致行为差异，也需要单独说明。

5. **形状/广播/一致性约束**
   - 描述所有“张量之间的形状关系”：必须一致、可以广播的维度、长度必须相等的轴等。
   - 如果有批次维、通道维、空间维等特定含义，也一并说明（完全基于文档）。

6. **其他重要约束**
   - 如支持/不支持的设备或产品型号、算子局限性、内存对齐要求、性能相关限制等。
   - 任何可能导致运行时报错或结果不正确的前置条件。

7. **输出格式要求**
   请使用下面的结构化 Markdown 格式输出，方便后续程序解析：

   - 接口名称：
   - 功能概述：

   - 输入输出约束：
     - 输入：
       - ...
     - 输出：
       - ...

   - 参数约束（逐参数列出）：
     - 参数名：
       - 角色：
       - 数据类型限制：
       - 形状/维度要求：
       - 取值范围：
       - 是否必填及默认值：
       - 其他约束：

   - 数据类型匹配规则：
     - ...

   - 形状与广播约束：
     - ...

   - 其他约束：
     - ...

要求：
- **只根据我提供的文档内容提取约束，不要自己杜撰接口中未提到的新特性或约束**。
- 若文档中没有明确说明某一项，就写“文档未说明”，不要凭常识补全。
- 尽量把所有与“能不能正确调用这个接口”相关的细节都提取出来，使生成的约束尽可能完备和可检查。
