---
title: "《随机过程》第二章-马尔科夫链（Markov chain）"
date: "2026-01-10"
description: "参考教材：《随机过程及其在金融中的应用》参考视频：BV1ui4y177sj"
tags: ["随机过程", "马尔科夫链"]
---

## 《随机过程》第二章-马尔科夫链（Markov chain）

| 状态空间 \\ 时间参数 | 离散 (D) | 连续 (C)             |
| -------------------- | -------- | -------------------- |
| 离散 (D)             | 马氏链   | 连续时间马氏链       |
| 连续 (C)             | -        | 布朗运动（金融数学） |

### 定义和例子

#### 定义

考虑一个离散时间的随机过程 $X_n\ (n=0,1,2,\ldots)$，$X_n$ 在有限集合内取值。我们称 $X_n$ 的所有可能取值为系统的**状态**（state）。

定义**转移概率**（transition probability），其表达式如下：
$$
p_{n+1}(i,j)=\mathbb{P}\!\left(X_{n+1}=j \mid X_n=i,\ X_{n-1}=i_{n-1},\ X_{n-2}=i_{n-2},\ \ldots,\ X_0=i_0\right).
$$

（时间轴：$\cdots\ X_{n-2}\ \ X_{n-1}\ \ X_n\ \ X_{n+1}\ \ X_{n+2}\ \cdots$，对应“过去—现在—将来”）

如果$p_{n+1}(i,j)=\mathbb{P}(X_{n+1}=j\mid X_n=i)$,称这个过程具有**马氏性**（Markov property），即：$X_{n+1}$ 只与 $X_n$ 有关，而与之前的状态 $(X_{n-1},\ldots,X_0)$ 无关。

如果时刻 $n$ 的取值与转移概率无关，即
$$
\mathbb{P}(X_{n+1}=j\mid X_n=i)=p(i,j),\qquad \forall n,
$$
则称为**时齐性**（time-homogeneous），相应的马氏链称作**时齐马氏链**。

> 后面的讨论默认马氏性和时齐性成立

#### 例 1：赌徒破产问题

赌徒在一次赌博中，赢得 $1$ 美元的概率是 $0.4$；输掉 $1$ 美元的概率是 $0.6$。赌徒退出赌博的条件为：输光（财富为 $0$），或者财富数额达到 $N$ 美元。

假设随机变量 $X_n$ 表示赌徒在第 $n$ 次赌博后的财富数量。可见 $X_{n+1}$ 只与 $X_n$ 有关，而与之前的状态 $(X_{n-1},\ldots,X_0)$ 无关，$X_n$ 具有**马氏性**（Markov property），即：
$$
\mathbb{P}\!\left(
X_{n+1}=j \mid X_n=i,\ X_{n-1}=i_{n-1},\ X_{n-2}=i_{n-2},\ldots,\ X_0=i_0
\right)
$$

$$
=
\mathbb{P}(X_{n+1}=j\mid X_n=i)
= p(i,j).
$$

马氏性的另一类表述：已知“现在” $X_n$ 的条件下，“将来” $X_{n+1}$ 与“过去” $(X_{n-1},\ldots,X_1,X_0)$ 无关的特性。

$p(i,j)$ 就是转移概率，其满足
$$
p(i,j)=\mathbb{P}(X_{n+1}=j\mid X_n=i).
$$

赌徒第 $(n+1)$ 次赌博，输钱的条件概率分别为：
$$
p(i,i-1)=\mathbb{P}(X_{n+1}=i-1\mid X_n=i)=0.6,\quad \text{输}
$$
$$
p(i,i+1)=\mathbb{P}(X_{n+1}=i+1\mid X_n=i)=0.4,\quad \text{赢}
$$

该问题中的转移概率取值分别为：
$$
p(i,i+1)=0.4,\qquad p(i,i-1)=0.6,\qquad 0<i<N,
$$
$$
p(0,0)=1,\qquad p(N,N)=1,\qquad \text{此时赌博停止}.
$$

$p(i,j)$ 的相应数值，可以标注在矩阵 $P$ 的第 $i$ 行、第 $j$ 列。这个矩阵称为**转移矩阵**（transition matrix）：
$$
P=
\begin{pmatrix}
p(0,0) & p(0,1) & \cdots & p(0,N)\\
p(1,0) & p(1,1) & \cdots & p(1,N)\\
\vdots & \vdots & \ddots & \vdots\\
p(N,0) & p(N,1) & \cdots & p(N,N)
\end{pmatrix}.
$$
当 $N=5$ 时，转移矩阵如下（列标为 $0,1,2,3,4,5$）：
$$
P=
\begin{pmatrix}
1   & 0   & 0   & 0   & 0   & 0 \\
0.6 & 0   & 0.4 & 0   & 0   & 0 \\
0   & 0.6 & 0   & 0.4 & 0   & 0 \\
0   & 0   & 0.6 & 0   & 0.4 & 0 \\
0   & 0   & 0   & 0.6 & 0   & 0.4 \\
0   & 0   & 0   & 0   & 0   & 1
\end{pmatrix}.
$$
![image-20260110102907866](./markov-chain.png)

从图形上看，赌徒破产问题相当于一维带有吸收壁垒的随机游动（random walk with absorbing boundary）。

注意到：$p(0,0)=1$，$p(5,5)=1$。赌徒破产问题中的状态 $0$ 和状态 $5$ 均称为**吸收态**（absorbing state）。

### 多步转移概率



### 状态的分类